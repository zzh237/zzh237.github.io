<aside id="sidebar" class="open">
  <div id="sidebar-left">
    <a id="sidebar-avatar" href="{{ "/" | prepend: site.baseurl }}">
      <img id="sidebar-avatar-img" alt="{{ site.tittle }}" src="{{ site.avatar | prepend: site.baseurl }}"/>
    </a>

    <div id="sidebar-social">
      <!-- <a href="{{ site.rss_url | prepend: site.baseurl }}" class="sidebar-social-icon feed"></a> -->
      <a href="mailto:{{ site.email }}" class="sidebar-social-icon email"></a>
      {% include social.html %}
    </div>

    <ul id="sidebar-tags">
      <!-- <li class="sidebar-tag active" data-filter="recent">{{ category | first }}</li> -->
      {% if site.filter == 'category' %}
        {% for category in site.categories %}
          <li class="sidebar-tag" data-filter="{{ category | first }}">{{ category | first }}</li>
        {% endfor %}
      {% elsif site.filter == 'tag' %}
        {% for tag in site.tags %}
          <li class="sidebar-tag" data-filter="{{ tag | first }}">{{ tag | first }}</li>
        {% endfor %}
      {% endif %}
    </ul>  
  </div>

  <div id="sidebar-right">
    <div id="search-box">
      <input id="search-input" type="text" placeholder="Search" />
    </div>
    <nav id="toc">
      {% assign recent_posts = site.posts | limit: 3 %}
      {% assign active_category = page.category %}
      {% assign active_tag = page.tag %}
    
      {% if active_category or active_tag %}
        <!-- 显示选中分类或标签下的文章 -->
        {% if active_category %}
          {% assign filtered_posts = site.posts | where: "category", active_category %}
        {% elsif active_tag %}
          {% assign filtered_posts = site.posts | where: "tag", active_tag %}
        {% endif %}
        {% for post in filtered_posts %}
          <a class="toc-link" data-tags="{{ post.categories | join: ' ' }}" href="{{ post.url }}">
            {{ post.title }}
          </a>
        {% endfor %}
      {% else %}
        <!-- 默认显示最近的三篇文章 -->
        {% for post in recent_posts %}
          <a class="toc-link" data-tags="{{ post.categories | join: ' ' }}" href="{{ post.url }}">
            {{ post.title }}
          </a>
        {% endfor %}
      {% endif %}
    </nav>
    
  </div>
</aside>
